"use strict";
var touch = [0, 0];
var api = require('../../utils/request/api');
Component({
    properties: {
        loginStatus: {
            type: String,
            value: 'false',
        }
    },
    data: {
        cardData: [
            {
                id: 0,
                name: '壁花少年',
                image: 'https://movie-1256948132.cos.ap-beijing.myqcloud.com/p1874816818.jpg',
                detail: '查理（罗根·勒曼 Logan Lerman 饰）是个害羞和孤独的高中新生，拥有超越年龄的敏感和泪腺，总是默默观察身边的家人和朋友，是个典型的「壁花少年」。他的青春期充满各种挫折，先后经历了阿姨为给他买生日礼物去世、最好朋友自杀、受同侪排挤欺负、单恋没有回应等各种事情。然而查理还不是最惨的，因为和他一样被生活逼入墙角罚站的人实在太多。他幸运的拥有一个开明的老师和两个高年级的好友：叛逆娇俏的少女珊（艾玛·沃森 Emma Watson 饰）和自信满满的同志男生帕特里克（埃兹拉·米勒 Ezra Miller 饰），他们让查理明白了有时候不能永远旁观，必须要参与进来才能拥有属于自己的精彩。 ',
                category: '青春 / 成长 / 美国 / 爱情',
            },
            {
                id: 1,
                name: '十面埋伏',
                image: 'https://movie-1256948132.cos.ap-beijing.myqcloud.com/p1874816818.jpg',
                detail: '查理（罗根·勒曼 Logan Lerman 饰）是个害羞和孤独的高中新生，拥有超越年龄的敏感和泪腺，总是默默观察身边的家人和朋友，是个典型的「壁花少年」。他的青春期充满各种挫折，先后经历了阿姨为给他买生日礼物去世、最好朋友自杀、受同侪排挤欺负、单恋没有回应等各种事情。然而查理还不是最惨的，因为和他一样被生活逼入墙角罚站的人实在太多。他幸运的拥有一个开明的老师和两个高年级的好友：叛逆娇俏的少女珊（艾玛·沃森 Emma Watson 饰）和自信满满的同志男生帕特里克（埃兹拉·米勒 Ezra Miller 饰），他们让查理明白了有时候不能永远旁观，必须要参与进来才能拥有属于自己的精彩。 ',
                category: '青春 / 成长 / 美国 / 爱情',
            },
            {
                id: 2,
                name: '笑傲江湖',
                image: 'https://movie-1256948132.cos.ap-beijing.myqcloud.com/p1874816818.jpg',
                detail: '查理（罗根·勒曼 Logan Lerman 饰）是个害羞和孤独的高中新生，拥有超越年龄的敏感和泪腺，总是默默观察身边的家人和朋友，是个典型的「壁花少年」。他的青春期充满各种挫折，先后经历了阿姨为给他买生日礼物去世、最好朋友自杀、受同侪排挤欺负、单恋没有回应等各种事情。然而查理还不是最惨的，因为和他一样被生活逼入墙角罚站的人实在太多。他幸运的拥有一个开明的老师和两个高年级的好友：叛逆娇俏的少女珊（艾玛·沃森 Emma Watson 饰）和自信满满的同志男生帕特里克（埃兹拉·米勒 Ezra Miller 饰），他们让查理明白了有时候不能永远旁观，必须要参与进来才能拥有属于自己的精彩。 ',
                category: '青春 / 成长 / 美国 / 爱情',
            },
        ],
        testCurrentNav: 0,
        currentIndex: 0,
        currentCard: {},
        cardDistance: 0,
        classArray: ['active', 'next'],
    },
    methods: {
        onTouchStart: function (e) {
            console.log(e);
            touch[0] = e.touches[0].clientX;
        },
        onTouchEnd: function (e) {
            touch[1] = e.changedTouches[0].clientX;
            if (touch[0] - touch[1] > 5) {
                this.addClassName('left');
            }
            else if (touch[1] - touch[0] > 5) {
                this.addClassName('right');
            }
        },
        addClassName: function (direction) {
            var currentIndex = this.data.currentIndex;
            var currentCard = {};
            var cardData = this.data.cardData;
            var length = cardData.length;
            var classArray = new Array(length);
            if (direction === 'left') {
                if (++currentIndex >= length)
                    return;
                classArray[currentIndex] = 'active';
                classArray[currentIndex - 1] = 'prev';
                if (currentIndex + 1 < length) {
                    classArray[currentIndex + 1] = 'next';
                }
            }
            else if (direction === 'right') {
                if (--currentIndex < 0)
                    return;
                if (currentIndex - 1 >= 0) {
                    classArray[currentIndex - 1] = 'prev';
                }
                classArray[currentIndex] = 'active';
                classArray[currentIndex + 1] = 'next';
            }
            currentCard = cardData[currentIndex];
            this.moveCard(direction);
            this.setData({
                currentIndex: currentIndex,
                classArray: classArray,
                currentCard: currentCard,
            });
        },
        moveCard: function (direction) {
            var cardDistance = this.data.cardDistance;
            if (direction === 'left') {
                cardDistance -= 549;
            }
            else if (direction === 'right') {
                cardDistance += 549;
            }
            this.setData({
                cardDistance: cardDistance
            });
        },
        getMovieList: function () {
            var _this = this;
            wx.showLoading({
                title: '获取电影列表...',
            });
            api.userTaskList().then(function (res) {
                console.log(res);
                var list = new Array();
                for (var index = 0; index < res.data.length; index++) {
                    var element = res.data[index];
                    list.push({
                        id: element.id,
                        name: element.name,
                        detail: element.detail,
                    });
                }
                console.log('赋值完成的 list 为:', list);
                _this.setData({
                    cardData: list
                });
            });
            wx.hideLoading();
        },
        onTapNavigateTo: function (e) {
            console.log(e);
            var id = e.currentTarget.dataset.id;
            console.log(id, e);
        },
        onTapLogin: function (e) {
            console.log(e);
            wx.login({
                success: function (res) {
                    console.log("第一步:授权登录码为:", res.code);
                    wx.setStorage({
                        data: res.code,
                        key: 'temp-auth-code'
                    });
                },
            });
        },
        getUserInfo: function (e) {
            var _this = this;
            console.log('第二步:授权获取到的信息为:', e);
            var code = wx.getStorageSync('temp-auth-code');
            api.wxLogin({
                code: code,
                encrypted_data: e.detail.encryptedData,
                iv: e.detail.iv,
            }).then(function (res) {
                console.log(res);
                _this.setUpUserToken(res);
            }).catch(function (err) {
                console.log(err);
            });
        },
        setUpUserToken: function (res) {
            wx.setStorage({
                data: 'Bearer ' + res.data.access_token,
                key: 'token',
                success: this.setLoginStatus(this.onLoginStatusChanged(this)),
            });
        },
        setLoginStatus: function (callBack) {
            return function (e) {
                console.log('设置 token 成功回调', e);
                wx.setStorage({
                    key: 'loginStatus',
                    data: true,
                    success: callBack
                });
            };
        },
        onLoginStatusChanged: function (self) {
            return function (e) {
                console.log('登录状态变更 回调', e);
                var myEventDetail = {};
                var myEventOption = {};
                self.triggerEvent('loginStatusUpdated', myEventDetail, myEventOption);
            };
        },
    },
    attached: function () {
        this.getMovieList();
        console.log('当前登录状态为:', this.properties.loginStatus);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FyZF9jYXJvdXNlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNhcmRfY2Fyb3VzZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBRW5CLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFBO0FBRTVDLFNBQVMsQ0FBQztJQUlOLFVBQVUsRUFBRTtRQUNSLFdBQVcsRUFBRTtZQUNULElBQUksRUFBRSxNQUFNO1lBQ1osS0FBSyxFQUFFLE9BQU87U0FDakI7S0FDSjtJQUtELElBQUksRUFBRTtRQUNGLFFBQVEsRUFBRTtZQUNOO2dCQUNJLEVBQUUsRUFBRSxDQUFDO2dCQUNMLElBQUksRUFBRSxNQUFNO2dCQUNaLEtBQUssRUFBRSxzRUFBc0U7Z0JBQzdFLE1BQU0sRUFBRSx3U0FBd1M7Z0JBQ2hULFFBQVEsRUFBRSxtQkFBbUI7YUFDaEM7WUFDRDtnQkFDSSxFQUFFLEVBQUUsQ0FBQztnQkFDTCxJQUFJLEVBQUUsTUFBTTtnQkFDWixLQUFLLEVBQUUsc0VBQXNFO2dCQUM3RSxNQUFNLEVBQUUsd1NBQXdTO2dCQUNoVCxRQUFRLEVBQUUsbUJBQW1CO2FBQ2hDO1lBQ0Q7Z0JBQ0ksRUFBRSxFQUFFLENBQUM7Z0JBQ0wsSUFBSSxFQUFFLE1BQU07Z0JBQ1osS0FBSyxFQUFFLHNFQUFzRTtnQkFDN0UsTUFBTSxFQUFFLHdTQUF3UztnQkFDaFQsUUFBUSxFQUFFLG1CQUFtQjthQUNoQztTQUNKO1FBQ0QsY0FBYyxFQUFFLENBQUM7UUFDakIsWUFBWSxFQUFFLENBQUM7UUFDZixXQUFXLEVBQUUsRUFBRTtRQUVmLFlBQVksRUFBRSxDQUFDO1FBQ2YsVUFBVSxFQUFFLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQztLQUNqQztJQUtELE9BQU8sRUFBRTtRQUVMLFlBQVksRUFBWixVQUFhLENBQU07WUFDZixPQUFPLENBQUMsR0FBRyxD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O2FBQ2hFLENBQUMsQ0FBQTtRQUNOLENBQUM7UUFFRCxjQUFjLEVBQWQsVUFBZSxRQUFxRDtZQUNoRSxPQUFPLFVBQVUsQ0FBMEM7Z0JBQ3ZELE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxDQUFBO2dCQU0vQixFQUFFLENBQUMsVUFBVSxDQUFDO29CQUNWLEdBQUcsRUFBRSxhQUFhO29CQUNsQixJQUFJLEVBQUUsSUFBSTtvQkFDVixPQUFPLEVBQUUsUUFBUTtpQkFDcEIsQ0FBQyxDQUFBO1lBQ04sQ0FBQyxDQUFBO1FBQ0wsQ0FBQztRQUVELG9CQUFvQixFQUFwQixVQUFxQixJQUFJO1lBQ3JCLE9BQU8sVUFBVSxDQUEwQztnQkFDdkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUE7Z0JBQzNCLElBQUksYUFBYSxHQUFHLEVBQUUsQ0FBQTtnQkFDdEIsSUFBSSxhQUFhLEdBQUcsRUFBRSxDQUFBO2dCQUN0QixJQUFJLENBQUMsWUFBWSxDQUFDLG9CQUFvQixFQUFFLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQTtZQUN6RSxDQUFDLENBQUE7UUFDTCxDQUFDO0tBQ0o7SUFFRCxRQUFRO1FBQ0osSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDeEQsQ0FBQztDQUNKLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGNvbXBvbmVudHMvY2FyZF9jYXJvdXNlbC9jYXJkX2Nhcm91c2VsLnRzXG5cbnZhciB0b3VjaCA9IFswLCAwXTtcbi8qKkB2YXIgQXBpUmVxdWVzdC5SZXF1c2V0ICovXG52YXIgYXBpID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvcmVxdWVzdC9hcGknKVxuXG5Db21wb25lbnQoe1xuICAgIC8qKlxuICAgICAqIOe7hOS7tueahOWxnuaAp+WIl+ihqFxuICAgICAqL1xuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbG9naW5TdGF0dXM6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIHZhbHVlOiAnZmFsc2UnLFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOe7hOS7tueahOWIneWni+aVsOaNrlxuICAgICAqL1xuICAgIGRhdGE6IHtcbiAgICAgICAgY2FyZERhdGE6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogMCxcbiAgICAgICAgICAgICAgICBuYW1lOiAn5aOB6Iqx5bCR5bm0JyxcbiAgICAgICAgICAgICAgICBpbWFnZTogJ2h0dHBzOi8vbW92aWUtMTI1Njk0ODEzMi5jb3MuYXAtYmVpamluZy5teXFjbG91ZC5jb20vcDE4NzQ4MTY4MTguanBnJyxcbiAgICAgICAgICAgICAgICBkZXRhaWw6ICfmn6XnkIbvvIjnvZfmoLnCt+WLkuabvCBMb2dhbiBMZXJtYW4g6aWw77yJ5piv5Liq5a6z576e5ZKM5a2k54us55qE6auY5Lit5paw55Sf77yM5oul5pyJ6LaF6LaK5bm06b6E55qE5pWP5oSf5ZKM5rOq6IW677yM5oC75piv6buY6buY6KeC5a+f6Lqr6L6555qE5a625Lq65ZKM5pyL5Y+L77yM5piv5Liq5YW45Z6L55qE44CM5aOB6Iqx5bCR5bm044CN44CC5LuW55qE6Z2S5pil5pyf5YWF5ruh5ZCE56eN5oyr5oqY77yM5YWI5ZCO57uP5Y6G5LqG6Zi/5aeo5Li657uZ5LuW5Lmw55Sf5pel56S854mp5Y675LiW44CB5pyA5aW95pyL5Y+L6Ieq5p2A44CB5Y+X5ZCM5L6q5o6S5oyk5qy66LSf44CB5Y2V5oGL5rKh5pyJ5Zue5bqU562J5ZCE56eN5LqL5oOF44CC54S26ICM5p+l55CG6L+Y5LiN5piv5pyA5oOo55qE77yM5Zug5Li65ZKM5LuW5LiA5qC36KKr55Sf5rS76YC85YWl5aKZ6KeS572a56uZ55qE5Lq65a6e5Zyo5aSq5aSa44CC5LuW5bm46L+Q55qE5oul5pyJ5LiA5Liq5byA5piO55qE6ICB5biI5ZKM5Lik5Liq6auY5bm057qn55qE5aW95Y+L77ya5Y+b6YCG5aiH5L+P55qE5bCR5aWz54+K77yI6Im+546bwrfmsoPmo64gRW1tYSBXYXRzb24g6aWw77yJ5ZKM6Ieq5L+h5ruh5ruh55qE5ZCM5b+X55S355Sf5biV54m56YeM5YWL77yI5Z+D5YW55ouJwrfnsbPli5IgRXpyYSBNaWxsZXIg6aWw77yJ77yM5LuW5Lus6K6p5p+l55CG5piO55m95LqG5pyJ5pe25YCZ5LiN6IO95rC46L+c5peB6KeC77yM5b+F6aG76KaB5Y+C5LiO6L+b5p2l5omN6IO95oul5pyJ5bGe5LqO6Ieq5bex55qE57K+5b2p44CCICcsXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICfpnZLmmKUgLyDmiJDplb8gLyDnvo7lm70gLyDniLHmg4UnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgICAgICBuYW1lOiAn5Y2B6Z2i5Z+L5LyPJyxcbiAgICAgICAgICAgICAgICBpbWFnZTogJ2h0dHBzOi8vbW92aWUtMTI1Njk0ODEzMi5jb3MuYXAtYmVpamluZy5teXFjbG91ZC5jb20vcDE4NzQ4MTY4MTguanBnJyxcbiAgICAgICAgICAgICAgICBkZXRhaWw6ICfmn6XnkIbvvIjnvZfmoLnCt+WLkuabvCBMb2dhbiBMZXJtYW4g6aWw77yJ5piv5Liq5a6z576e5ZKM5a2k54us55qE6auY5Lit5paw55Sf77yM5oul5pyJ6LaF6LaK5bm06b6E55qE5pWP5oSf5ZKM5rOq6IW677yM5oC75piv6buY6buY6KeC5a+f6Lqr6L6555qE5a625Lq65ZKM5pyL5Y+L77yM5piv5Liq5YW45Z6L55qE44CM5aOB6Iqx5bCR5bm044CN44CC5LuW55qE6Z2S5pil5pyf5YWF5ruh5ZCE56eN5oyr5oqY77yM5YWI5ZCO57uP5Y6G5LqG6Zi/5aeo5Li657uZ5LuW5Lmw55Sf5pel56S854mp5Y675LiW44CB5pyA5aW95pyL5Y+L6Ieq5p2A44CB5Y+X5ZCM5L6q5o6S5oyk5qy66LSf44CB5Y2V5oGL5rKh5pyJ5Zue5bqU562J5ZCE56eN5LqL5oOF44CC54S26ICM5p+l55CG6L+Y5LiN5piv5pyA5oOo55qE77yM5Zug5Li65ZKM5LuW5LiA5qC36KKr55Sf5rS76YC85YWl5aKZ6KeS572a56uZ55qE5Lq65a6e5Zyo5aSq5aSa44CC5LuW5bm46L+Q55qE5oul5pyJ5LiA5Liq5byA5piO55qE6ICB5biI5ZKM5Lik5Liq6auY5bm057qn55qE5aW95Y+L77ya5Y+b6YCG5aiH5L+P55qE5bCR5aWz54+K77yI6Im+546bwrfmsoPmo64gRW1tYSBXYXRzb24g6aWw77yJ5ZKM6Ieq5L+h5ruh5ruh55qE5ZCM5b+X55S355Sf5biV54m56YeM5YWL77yI5Z+D5YW55ouJwrfnsbPli5IgRXpyYSBNaWxsZXIg6aWw77yJ77yM5LuW5Lus6K6p5p+l55CG5piO55m95LqG5pyJ5pe25YCZ5LiN6IO95rC46L+c5peB6KeC77yM5b+F6aG76KaB5Y+C5LiO6L+b5p2l5omN6IO95oul5pyJ5bGe5LqO6Ieq5bex55qE57K+5b2p44CCICcsXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICfpnZLmmKUgLyDmiJDplb8gLyDnvo7lm70gLyDniLHmg4UnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogMixcbiAgICAgICAgICAgICAgICBuYW1lOiAn56yR5YKy5rGf5rmWJyxcbiAgICAgICAgICAgICAgICBpbWFnZTogJ2h0dHBzOi8vbW92aWUtMTI1Njk0ODEzMi5jb3MuYXAtYmVpamluZy5teXFjbG91ZC5jb20vcDE4NzQ4MTY4MTguanBnJyxcbiAgICAgICAgICAgICAgICBkZXRhaWw6ICfmn6XnkIbvvIjnvZfmoLnCt+WLkuabvCBMb2dhbiBMZXJtYW4g6aWw77yJ5piv5Liq5a6z576e5ZKM5a2k54us55qE6auY5Lit5paw55Sf77yM5oul5pyJ6LaF6LaK5bm06b6E55qE5pWP5oSf5ZKM5rOq6IW677yM5oC75piv6buY6buY6KeC5a+f6Lqr6L6555qE5a625Lq65ZKM5pyL5Y+L77yM5piv5Liq5YW45Z6L55qE44CM5aOB6Iqx5bCR5bm044CN44CC5LuW55qE6Z2S5pil5pyf5YWF5ruh5ZCE56eN5oyr5oqY77yM5YWI5ZCO57uP5Y6G5LqG6Zi/5aeo5Li657uZ5LuW5Lmw55Sf5pel56S854mp5Y675LiW44CB5pyA5aW95pyL5Y+L6Ieq5p2A44CB5Y+X5ZCM5L6q5o6S5oyk5qy66LSf44CB5Y2V5oGL5rKh5pyJ5Zue5bqU562J5ZCE56eN5LqL5oOF44CC54S26ICM5p+l55CG6L+Y5LiN5piv5pyA5oOo55qE77yM5Zug5Li65ZKM5LuW5LiA5qC36KKr55Sf5rS76YC85YWl5aKZ6KeS572a56uZ55qE5Lq65a6e5Zyo5aSq5aSa44CC5LuW5bm46L+Q55qE5oul5pyJ5LiA5Liq5byA5piO55qE6ICB5biI5ZKM5Lik5Liq6auY5bm057qn55qE5aW95Y+L77ya5Y+b6YCG5aiH5L+P55qE5bCR5aWz54+K77yI6Im+546bwrfmsoPmo64gRW1tYSBXYXRzb24g6aWw77yJ5ZKM6Ieq5L+h5ruh5ruh55qE5ZCM5b+X55S355Sf5biV54m56YeM5YWL77yI5Z+D5YW55ouJwrfnsbPli5IgRXpyYSBNaWxsZXIg6aWw77yJ77yM5LuW5Lus6K6p5p+l55CG5piO55m95LqG5pyJ5pe25YCZ5LiN6IO95rC46L+c5peB6KeC77yM5b+F6aG76KaB5Y+C5LiO6L+b5p2l5omN6IO95oul5pyJ5bGe5LqO6Ieq5bex55qE57K+5b2p44CCICcsXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICfpnZLmmKUgLyDmiJDplb8gLyDnvo7lm70gLyDniLHmg4UnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgdGVzdEN1cnJlbnROYXY6IDAsXG4gICAgICAgIGN1cnJlbnRJbmRleDogMCxcbiAgICAgICAgY3VycmVudENhcmQ6IHt9LFxuICAgICAgICAvLyBtb3ZpZUFuaW1hdGlvbkRhdGE6ICcnLFxuICAgICAgICBjYXJkRGlzdGFuY2U6IDAsXG4gICAgICAgIGNsYXNzQXJyYXk6IFsnYWN0aXZlJywgJ25leHQnXSwgLy8g5a6a5LmJY2xhc3PmlbDnu4TvvIzlrZjmlL7moLflvI9jbGFzc++8jFxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDnu4Tku7bnmoTmlrnms5XliJfooahcbiAgICAgKi9cbiAgICBtZXRob2RzOiB7XG4gICAgICAgIC8vIOW8gOWni+a7keWKqFxuICAgICAgICBvblRvdWNoU3RhcnQoZTogYW55KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKVxuXG4gICAgICAgICAgICB0b3VjaFswXSA9IGUudG91Y2hlc1swXS5jbGllbnRYXG4gICAgICAgIH0sXG4gICAgICAgIC8vIOe7k+adn+a7keWKqFxuICAgICAgICBvblRvdWNoRW5kKGU6IGFueSkge1xuICAgICAgICAgICAgdG91Y2hbMV0gPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgICAgICBpZiAodG91Y2hbMF0gLSB0b3VjaFsxXSA+IDUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENsYXNzTmFtZSgnbGVmdCcpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0b3VjaFsxXSAtIHRvdWNoWzBdID4gNSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3NOYW1lKCdyaWdodCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhZGRDbGFzc05hbWUoZGlyZWN0aW9uOiBhbnkpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50SW5kZXggPSB0aGlzLmRhdGEuY3VycmVudEluZGV4XG4gICAgICAgICAgICBsZXQgY3VycmVudENhcmQgPSB7fVxuICAgICAgICAgICAgbGV0IGNhcmREYXRhID0gdGhpcy5kYXRhLmNhcmREYXRhXG4gICAgICAgICAgICBsZXQgbGVuZ3RoID0gY2FyZERhdGEubGVuZ3RoXG4gICAgICAgICAgICBsZXQgY2xhc3NBcnJheSA9IG5ldyBBcnJheShsZW5ndGgpXG5cbiAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JykgeyAgLy8g5ZCR5bem5ruR5YqoXG4gICAgICAgICAgICAgICAgaWYgKCsrY3VycmVudEluZGV4ID49IGxlbmd0aCkgcmV0dXJuXG5cbiAgICAgICAgICAgICAgICBjbGFzc0FycmF5W2N1cnJlbnRJbmRleF0gPSAnYWN0aXZlJztcbiAgICAgICAgICAgICAgICBjbGFzc0FycmF5W2N1cnJlbnRJbmRleCAtIDFdID0gJ3ByZXYnO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggKyAxIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzQXJyYXlbY3VycmVudEluZGV4ICsgMV0gPSAnbmV4dCc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JykgeyAgLy8g5ZCR5Y+z5ruR5YqoXG4gICAgICAgICAgICAgICAgaWYgKC0tY3VycmVudEluZGV4IDwgMCkgcmV0dXJuXG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEluZGV4IC0gMSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzQXJyYXlbY3VycmVudEluZGV4IC0gMV0gPSAncHJldic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNsYXNzQXJyYXlbY3VycmVudEluZGV4XSA9ICdhY3RpdmUnO1xuICAgICAgICAgICAgICAgIGNsYXNzQXJyYXlbY3VycmVudEluZGV4ICsgMV0gPSAnbmV4dCc7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3VycmVudENhcmQgPSBjYXJkRGF0YVtjdXJyZW50SW5kZXhdXG4gICAgICAgICAgICB0aGlzLm1vdmVDYXJkKGRpcmVjdGlvbilcblxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXgsXG4gICAgICAgICAgICAgICAgY2xhc3NBcnJheSxcbiAgICAgICAgICAgICAgICBjdXJyZW50Q2FyZCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIC8vIOWIm+W7uuW5s+enu+WKqOeUu1xuICAgICAgICBtb3ZlQ2FyZChkaXJlY3Rpb246IGFueSkge1xuICAgICAgICAgICAgLy8gbGV0IGN1cnJlbnRJbmRleCA9IHRoaXMuZGF0YS5jdXJyZW50SW5kZXggKyAxXG4gICAgICAgICAgICBsZXQgY2FyZERpc3RhbmNlID0gdGhpcy5kYXRhLmNhcmREaXN0YW5jZVxuXG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcbiAgICAgICAgICAgICAgICBjYXJkRGlzdGFuY2UgLT0gNTQ5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgICAgIGNhcmREaXN0YW5jZSArPSA1NDlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICBjYXJkRGlzdGFuY2VcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDojrflj5bnlLXlvbHkv6Hmga9cbiAgICAgICAgICovXG4gICAgICAgIGdldE1vdmllTGlzdCgpIHtcbiAgICAgICAgICAgIHd4LnNob3dMb2FkaW5nKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+iOt+WPlueUteW9seWIl+ihqC4uLicsXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvL+aLieWPluaVsOaNrui/m+ihjOaYvuekulxuICAgICAgICAgICAgYXBpLnVzZXJUYXNrTGlzdCgpLnRoZW4oKHJlczogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICAgICAgICAgIGxldCBsaXN0ID0gbmV3IEFycmF5KClcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzLmRhdGEubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZXMuZGF0YVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogZWxlbWVudC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogZWxlbWVudC5kZXRhaWwsXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+i1i+WAvOWujOaIkOeahCBsaXN0IOS4ujonLCBsaXN0KVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgICAgIGNhcmREYXRhOiBsaXN0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHd4LmhpZGVMb2FkaW5nKClcbiAgICAgICAgICAgIC8vIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICAvLyAgICAgY2FyZERhdGE6IGRhdGEuZGF0YSxcbiAgICAgICAgICAgIC8vICAgICBjdXJyZW50Q2FyZDogZGF0YS5kYXRhWzBdXG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICB9LFxuICAgICAgICAvLyDlrp7njrDpobXpnaLot7PovaxcbiAgICAgICAgb25UYXBOYXZpZ2F0ZVRvKGU6IGFueSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgIGxldCBpZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmlkXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpZCwgZSlcblxuICAgICAgICAgICAgLy8gd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgICAvLyAgICAgdXJsOiAnL3BhZ2VzL2F1dGhvcml6ZS9hdXRob3JpemUnLFxuICAgICAgICAgICAgLy8gfSlcbiAgICAgICAgfSxcblxuICAgICAgICAvL+azqOaEj+WFiOiwgyBsb2dpbizlho3osIMgdXNlckluZm9cbiAgICAgICAgLy9odHRwczovL2RldmVsb3BlcnMud2VpeGluLnFxLmNvbS9taW5pcHJvZ3JhbS9kZXYvZnJhbWV3b3JrL29wZW4tYWJpbGl0eS9zaWduYXR1cmUuaHRtbCMlRTUlOEElQTAlRTUlQUYlODYlRTYlOTUlQjAlRTYlOEQlQUUlRTglQTclQTMlRTUlQUYlODYlRTclQUUlOTclRTYlQjMlOTVcbiAgICAgICAgb25UYXBMb2dpbihlOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpXG5cbiAgICAgICAgICAgIC8v5o6I5p2DIGNvZGUg5pyJ5pWI5pyf5Y+q5pyJIDUg5YiG6ZKfLlxuICAgICAgICAgICAgd3gubG9naW4oe1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi56ys5LiA5q2lOuaOiOadg+eZu+W9leeggeS4ujpcIiwgcmVzLmNvZGUpXG4gICAgICAgICAgICAgICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmVzLmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6ICd0ZW1wLWF1dGgtY29kZSdcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLy8g5Y+R6YCBIHJlcy5jb2RlIOWIsOWQjuWPsOaNouWPliBvcGVuSWQsIHNlc3Npb25LZXksIHVuaW9uSWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRVc2VySW5mbyhlOiBhbnkpIHtcbiAgICAgICAgICAgIC8v5b6u5L+h5oKo5paH5Lu25a2Y5YKoXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3BlcnMud2VpeGluLnFxLmNvbS9taW5pcHJvZ3JhbS9kZXYvYXBpL3N0b3JhZ2Uvd3guZ2V0U3RvcmFnZVN5bmMuaHRtbFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+esrOS6jOatpTrmjojmnYPojrflj5bliLDnmoTkv6Hmga/kuLo6JywgZSlcbiAgICAgICAgICAgIHZhciBjb2RlID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3RlbXAtYXV0aC1jb2RlJylcbiAgICAgICAgICAgIGFwaS53eExvZ2luKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBjb2RlLFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhOiBlLmRldGFpbC5lbmNyeXB0ZWREYXRhLFxuICAgICAgICAgICAgICAgIGl2OiBlLmRldGFpbC5pdixcbiAgICAgICAgICAgIH0pLnRoZW4oKHJlczogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXBVc2VyVG9rZW4ocmVzKVxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VXBVc2VyVG9rZW4ocmVzOiBhbnkpIHtcbiAgICAgICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICAgICAgICAgIGRhdGE6ICdCZWFyZXIgJyArIHJlcy5kYXRhLmFjY2Vzc190b2tlbixcbiAgICAgICAgICAgICAgICBrZXk6ICd0b2tlbicsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogdGhpcy5zZXRMb2dpblN0YXR1cyh0aGlzLm9uTG9naW5TdGF0dXNDaGFuZ2VkKHRoaXMpKSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0TG9naW5TdGF0dXMoY2FsbEJhY2s6IFdlY2hhdE1pbmlwcm9ncmFtLlNldFN0b3JhZ2VTdWNjZXNzQ2FsbGJhY2spOiBXZWNoYXRNaW5pcHJvZ3JhbS5TZXRTdG9yYWdlU3VjY2Vzc0NhbGxiYWNrIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZTogV2VjaGF0TWluaXByb2dyYW0uR2VuZXJhbENhbGxiYWNrUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+iuvue9riB0b2tlbiDmiJDlip/lm57osIMnLCBlKVxuICAgICAgICAgICAgICAgIC8v6K6+572u55m75b2V5oiQ5YqfdGFnXG4gICAgICAgICAgICAgICAgLy8gd3guc2V0U3RvcmFnZVN5bmMoXG4gICAgICAgICAgICAgICAgLy8gICAgICdsb2dpblN0YXR1cycsXG4gICAgICAgICAgICAgICAgLy8gICAgIHRydWUsXG4gICAgICAgICAgICAgICAgLy8gKVxuICAgICAgICAgICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdsb2dpblN0YXR1cycsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGNhbGxCYWNrXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBvbkxvZ2luU3RhdHVzQ2hhbmdlZChzZWxmKTogV2VjaGF0TWluaXByb2dyYW0uU2V0U3RvcmFnZVN1Y2Nlc3NDYWxsYmFjayB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGU6IFdlY2hhdE1pbmlwcm9ncmFtLkdlbmVyYWxDYWxsYmFja1Jlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfnmbvlvZXnirbmgIHlj5jmm7Qg5Zue6LCDJywgZSlcbiAgICAgICAgICAgICAgICB2YXIgbXlFdmVudERldGFpbCA9IHt9IC8vIGRldGFpbOWvueixoe+8jOaPkOS+m+e7meS6i+S7tuebkeWQrOWHveaVsFxuICAgICAgICAgICAgICAgIHZhciBteUV2ZW50T3B0aW9uID0ge30gLy8g6Kem5Y+R5LqL5Lu255qE6YCJ6aG5XG4gICAgICAgICAgICAgICAgc2VsZi50cmlnZ2VyRXZlbnQoJ2xvZ2luU3RhdHVzVXBkYXRlZCcsIG15RXZlbnREZXRhaWwsIG15RXZlbnRPcHRpb24pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIGF0dGFjaGVkKCkge1xuICAgICAgICB0aGlzLmdldE1vdmllTGlzdCgpO1xuICAgICAgICBjb25zb2xlLmxvZygn5b2T5YmN55m75b2V54q25oCB5Li6OicsIHRoaXMucHJvcGVydGllcy5sb2dpblN0YXR1cylcbiAgICB9XG59KSJdfQ==