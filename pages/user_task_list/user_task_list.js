"use strict";
var api = require('../../utils/request/api');
var CONFIRM_USER_TASK = 1;
var CANCEL_USR_TASK = 2;
Page({
    data: {
        addflag: true,
        addimg: '../../images/activity_add.png',
        searchstr: '',
        listData: new Array(),
        hiddenModalPut: true,
        activeTask: {
            id: 0,
            name: '',
            detail: '',
            process: {},
            showMore: false,
            avatar: '',
            createdAt: '',
            taskID: 0,
        },
        updateDetail: '',
        existDetails: new Array(),
        buttons: [{ text: '取消', index: CANCEL_USR_TASK }, { text: '确定', index: CONFIRM_USER_TASK }],
        radioItems: [
            { name: '未完成', value: 'UNDONE' },
            { name: '完成', value: 'COMPLETED', checked: true },
        ],
    },
    onLoad: function () {
        this.loadData();
    },
    onShow: function () {
    },
    tap: function (e) {
        console.log(e);
    },
    addhandle: function () {
        console.log('触发搜索框右侧事件');
    },
    searchList: function (ev) {
        var e = ev.detail;
        this.setData({
            searchstr: e.detail.value
        });
    },
    endsearchList: function (e) {
        console.log('查询数据', e);
    },
    cancelsearch: function () {
        this.setData({
            searchstr: ''
        });
    },
    activity_clear: function (e) {
        console.log(e);
        this.setData({
            searchstr: ''
        });
    },
    loadData: function () {
        var _this = this;
        api.userTaskList({}).then(function (res) {
            var _a;
            console.log(res);
            var list = new Array();
            for (var index = 0; index < res.data.length; index++) {
                var element = res.data[index];
                list.push({
                    id: element.id,
                    name: element.name,
                    detail: element.detail,
                    process: {
                        id: element.process.id,
                        detail: element.process.detail,
                        completed: false,
                        details: (_a = element.process.details) !== null && _a !== void 0 ? _a : [],
                    },
                    showMore: false,
                    avatar: element.owner ? element.owner.avatar : 'none',
                    createdAt: element.created_at,
                    taskID: element.task_id
                });
            }
            console.log('赋值完成的 list 为:', list);
            _this.setData({
                listData: list
            });
        });
    },
    tapTaskItem: function (e) {
        console.log('点击了任务卡片,事件为:', e);
        var listData = this.data.listData;
        for (var index = 0; index < listData.length; index++) {
            var element = listData[index];
            if (e.currentTarget.dataset.itemId == element.id) {
                listData[index].showMore = !element.showMore;
            }
        }
        this.setData({
            listData: listData,
        });
    },
    onRightBtnTap: function (e) {
        console.log('点击右边的按钮事件并且被 catch', e);
        this.setData({
            activeTask: e.currentTarget.dataset.item,
            hiddenModalPut: !this.data.hiddenModalPut,
            existDetails: e.currentTarget.dataset.item.process.details
        });
    },
    cancel: function () {
        this.setData({
            hiddenModalPut: true
        });
    },
    confirm: function () {
        this.setData({
            hiddenModalPut: true
        });
    },
    textInput: function (e) {
        console.log('当前文本输入的事件为:', e);
        this.setData({
            updateDetail: e.detail.value
        });
    },
    tapDialogButton: function (e) {
        var _this = this;
        console.log('传入的事件为:', e);
        if (e.detail.item.index == CONFIRM_USER_TASK) {
            console.log('当前页面数据为:', this.data.activeTask);
            console.log('当前的 detail 数据为:', this.data.updateDetail);
            api.updateProcess({
                process_id: this.data.activeTask.process.id,
                detail: this.data.updateDetail,
                completed: 1,
            }).then(function (res) {
                console.log('更新用户任务细节返回结果为::', res);
                _this.setData({
                    hiddenModalPut: true
                });
                _this.loadData();
            }).catch(function (err) {
                console.log('更新用户任务细节失败,结果为:', err);
                _this.setData({
                    hiddenModalPut: true
                });
            });
        }
        else if (e.detail.item.index == CANCEL_USR_TASK) {
            this.setData({
                hiddenModalPut: true
            });
        }
    },
    radioChange: function (e) {
        console.log('点击了切换按钮');
        var items = this.data.radioItems;
        for (var i = 0; i < items.length; ++i) {
            items[i].checked = items[i].value == e.detail.value;
        }
        console.log(items);
        this.setData({
            radioItems: items
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlcl90YXNrX2xpc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1c2VyX3Rhc2tfbGlzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsSUFBSSxHQUFHLEdBQXVCLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFBO0FBeUJoRSxJQUFNLGlCQUFpQixHQUFHLENBQUMsQ0FBQTtBQUMzQixJQUFNLGVBQWUsR0FBRyxDQUFDLENBQUE7QUFFekIsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osT0FBTyxFQUFFLElBQUk7UUFDYixNQUFNLEVBQUUsK0JBQStCO1FBQ3ZDLFNBQVMsRUFBRSxFQUFFO1FBQ2IsUUFBUSxFQUFFLElBQUksS0FBSyxFQUFnQjtRQUduQyxjQUFjLEVBQUUsSUFBSTtRQUNwQixVQUFVLEVBQWdCO1lBQ3hCLEVBQUUsRUFBRSxDQUFDO1lBQ0wsSUFBSSxFQUFFLEVBQUU7WUFDUixNQUFNLEVBQUUsRUFBRTtZQUNWLE9BQU8sRUFBRSxFQUFFO1lBQ1gsUUFBUSxFQUFFLEtBQUs7WUFDZixNQUFNLEVBQUUsRUFBRTtZQUNWLFNBQVMsRUFBRSxFQUFFO1lBQ2IsTUFBTSxFQUFFLENBQUM7U0FDVjtRQUNELFlBQVksRUFBRSxFQUFFO1FBQ2hCLFlBQVksRUFBRSxJQUFJLEtBQUssRUFBVTtRQUNqQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQztRQUMzRixVQUFVLEVBQUU7WUFDVixFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRTtZQUNoQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO1NBQ2xEO0tBQ0Y7SUFFRCxNQUFNO1FBQ0osSUFBSSxDQUFD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QyxPQUFPLENBQUM7Z0JBQ1gsY0FBYyxFQUFFLElBQUk7YUFDckIsQ0FBQyxDQUFBO1NBQ0g7SUFFSCxDQUFDO0lBRUQsV0FBVyxFQUFYLFVBQVksQ0FBTTtRQUNoQixPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ3RCLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFBO1FBQ2hDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxFQUFFO1lBQ3JDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQTtTQUNwRDtRQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFFbEIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLFVBQVUsRUFBRSxLQUFLO1NBQ2xCLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FHRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy91c2VyX3Rhc2tfbGlzdC91c2VyX3Rhc2tfbGlzdC50c1xudmFyIGFwaTogQXBpUmVxdWVzdC5SZXF1ZXN0ID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvcmVxdWVzdC9hcGknKVxuXG5pbnRlcmZhY2UgVXNlclRhc2tJdGVtIHtcbiAgaWQ6IG51bWJlclxuICBuYW1lOiBzdHJpbmdcbiAgZGV0YWlsOiBzdHJpbmdcbiAgcHJvY2VzczogUHJvY2Vzc1xuICBzaG93TW9yZTogYm9vbGVhblxuICBhdmF0YXI6IHN0cmluZ1xuICBjcmVhdGVkQXQ6IHN0cmluZ1xuICB0YXNrSUQ6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgUHJvY2VzcyB7XG4gIGlkOiBudW1iZXJcbiAgY29tcGxldGVkOiBib29sZWFuXG4gIGRldGFpbDogc3RyaW5nXG4gIGRldGFpbHM6IEFycmF5PERldGFpbD5cbn1cblxuaW50ZXJmYWNlIERldGFpbCB7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgdGltZTogc3RyaW5nXG59XG5cbmNvbnN0IENPTkZJUk1fVVNFUl9UQVNLID0gMVxuY29uc3QgQ0FOQ0VMX1VTUl9UQVNLID0gMlxuXG5QYWdlKHtcbiAgZGF0YToge1xuICAgIGFkZGZsYWc6IHRydWUsICAvL+WIpOaWreaYr+WQpuaYvuekuuaQnOe0ouahhuWPs+S+p+mDqOWIhlxuICAgIGFkZGltZzogJy4uLy4uL2ltYWdlcy9hY3Rpdml0eV9hZGQucG5nJyxcbiAgICBzZWFyY2hzdHI6ICcnLFxuICAgIGxpc3REYXRhOiBuZXcgQXJyYXk8VXNlclRhc2tJdGVtPigpLFxuXG4gICAgLy/lj6/ku6XpgJrov4doaWRkZW7mmK/lkKbmjqnol4/lvLnlh7rmoYbnmoTlsZ7mgKfvvIzmnaXmjIflrprpgqPkuKrlvLnlh7rmoYZcbiAgICBoaWRkZW5Nb2RhbFB1dDogdHJ1ZSxcbiAgICBhY3RpdmVUYXNrOiA8VXNlclRhc2tJdGVtPntcbiAgICAgIGlkOiAwLFxuICAgICAgbmFtZTogJycsXG4gICAgICBkZXRhaWw6ICcnLFxuICAgICAgcHJvY2Vzczoge30sXG4gICAgICBzaG93TW9yZTogZmFsc2UsXG4gICAgICBhdmF0YXI6ICcnLFxuICAgICAgY3JlYXRlZEF0OiAnJyxcbiAgICAgIHRhc2tJRDogMCxcbiAgICB9LFxuICAgIHVwZGF0ZURldGFpbDogJycsXG4gICAgZXhpc3REZXRhaWxzOiBuZXcgQXJyYXk8RGV0YWlsPigpLFxuICAgIGJ1dHRvbnM6IFt7IHRleHQ6ICflj5bmtognLCBpbmRleDogQ0FOQ0VMX1VTUl9UQVNLIH0sIHsgdGV4dDogJ+ehruWumicsIGluZGV4OiBDT05GSVJNX1VTRVJfVEFTSyB9XSxcbiAgICByYWRpb0l0ZW1zOiBbXG4gICAgICB7IG5hbWU6ICfmnKrlrozmiJAnLCB2YWx1ZTogJ1VORE9ORScgfSxcbiAgICAgIHsgbmFtZTogJ+WujOaIkCcsIHZhbHVlOiAnQ09NUExFVEVEJywgY2hlY2tlZDogdHJ1ZSB9LFxuICAgIF0sXG4gIH0sXG5cbiAgb25Mb2FkKCkge1xuICAgIHRoaXMubG9hZERhdGEoKVxuICB9LFxuICBvblNob3coKSB7XG5cbiAgfSxcblxuICB0YXAoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coZSlcbiAgfSxcblxuICAvLyDmkJzntKLmoYblj7Pkvqcg5LqL5Lu2XG4gIGFkZGhhbmRsZSgpIHtcbiAgICBjb25zb2xlLmxvZygn6Kem5Y+R5pCc57Si5qGG5Y+z5L6n5LqL5Lu2JylcbiAgfSxcblxuICAvL+aQnOe0ouahhui+k+WFpeaXtuinpuWPkVxuICBzZWFyY2hMaXN0KGV2OiBhbnkpIHtcbiAgICBsZXQgZSA9IGV2LmRldGFpbDtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgc2VhcmNoc3RyOiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG4gIC8v5pCc57Si5Zue6LCDXG4gIGVuZHNlYXJjaExpc3QoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ+afpeivouaVsOaNricsIGUpXG4gIH0sXG4gIC8vIOWPlua2iOaQnOe0olxuICBjYW5jZWxzZWFyY2goKSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHNlYXJjaHN0cjogJydcbiAgICB9KVxuICB9LFxuICAvL+a4heepuuaQnOe0ouahhlxuICBhY3Rpdml0eV9jbGVhcihlOiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZyhlKVxuXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHNlYXJjaHN0cjogJydcbiAgICB9KVxuICB9LFxuXG4gIGxvYWREYXRhKCkge1xuICAgIGFwaS51c2VyVGFza0xpc3Qoe30pLnRoZW4oKHJlczogYW55KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICBsZXQgbGlzdDogQXJyYXk8VXNlclRhc2tJdGVtPiA9IG5ldyBBcnJheSgpXG4gICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzLmRhdGEubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZXMuZGF0YVtpbmRleF07XG4gICAgICAgIGxpc3QucHVzaCh7XG4gICAgICAgICAgaWQ6IGVsZW1lbnQuaWQsXG4gICAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLFxuICAgICAgICAgIGRldGFpbDogZWxlbWVudC5kZXRhaWwsXG4gICAgICAgICAgcHJvY2Vzczoge1xuICAgICAgICAgICAgaWQ6IGVsZW1lbnQucHJvY2Vzcy5pZCxcbiAgICAgICAgICAgIGRldGFpbDogZWxlbWVudC5wcm9jZXNzLmRldGFpbCxcbiAgICAgICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgICAgICBkZXRhaWxzOiBlbGVtZW50LnByb2Nlc3MuZGV0YWlscyA/PyBbXSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNob3dNb3JlOiBmYWxzZSxcbiAgICAgICAgICBhdmF0YXI6IGVsZW1lbnQub3duZXIgPyBlbGVtZW50Lm93bmVyLmF2YXRhciA6ICdub25lJyxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGVsZW1lbnQuY3JlYXRlZF9hdCxcbiAgICAgICAgICB0YXNrSUQ6IGVsZW1lbnQudGFza19pZFxuICAgICAgICB9KVxuXG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZygn6LWL5YC85a6M5oiQ55qEIGxpc3Qg5Li6OicsIGxpc3QpXG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBsaXN0RGF0YTogbGlzdFxuICAgICAgfSlcbiAgICB9KVxuICB9LFxuXG4gIHRhcFRhc2tJdGVtKGU6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCfngrnlh7vkuobku7vliqHljaHniYcs5LqL5Lu25Li6OicsIGUpXG4gICAgbGV0IGxpc3REYXRhID0gdGhpcy5kYXRhLmxpc3REYXRhXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGxpc3REYXRhLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGxpc3REYXRhW2luZGV4XTtcbiAgICAgIGlmIChlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pdGVtSWQgPT0gZWxlbWVudC5pZCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygn5oyJ57Si5byV5Y+W5Ye655qE5pWw5o2u5Li6OicsIGxpc3REYXRhW2luZGV4XSlcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ+S5i+WJjeaMiee0ouW8leWPluWHuueahOS4ujonLCBsaXN0RGF0YVtpbmRleF0pXG4gICAgICAgIGxpc3REYXRhW2luZGV4XS5zaG93TW9yZSA9ICFlbGVtZW50LnNob3dNb3JlXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBsaXN0RGF0YTogbGlzdERhdGEsXG4gICAgfSlcbiAgfSxcblxuICBvblJpZ2h0QnRuVGFwKGU6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCfngrnlh7vlj7PovrnnmoTmjInpkq7kuovku7blubbkuJTooqsgY2F0Y2gnLCBlKVxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBhY3RpdmVUYXNrOiBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pdGVtLFxuICAgICAgaGlkZGVuTW9kYWxQdXQ6ICF0aGlzLmRhdGEuaGlkZGVuTW9kYWxQdXQsXG4gICAgICBleGlzdERldGFpbHM6IGUuY3VycmVudFRhcmdldC5kYXRhc2V0Lml0ZW0ucHJvY2Vzcy5kZXRhaWxzXG4gICAgfSlcbiAgfSxcblxuICAvL+eCueWHu+aMiemSruW8ueWHuuaMh+WumueahGhpZGRlbk1vZGFsUHV05by55Ye65qGGXG4gIC8v5by55Ye65qGG55qE6KGo5Y2VXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8v5Y+W5raI5oyJ6ZKuXG4gIGNhbmNlbCgpIHtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgaGlkZGVuTW9kYWxQdXQ6IHRydWVcbiAgICB9KTtcbiAgfSxcbiAgLy/noa7orqRcbiAgY29uZmlybSgpIHtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgaGlkZGVuTW9kYWxQdXQ6IHRydWVcbiAgICB9KVxuICB9LFxuXG4gIHRleHRJbnB1dChlOiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZygn5b2T5YmN5paH5pys6L6T5YWl55qE5LqL5Lu25Li6OicsIGUpXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHVwZGF0ZURldGFpbDogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuXG4gIC8v5a+56K+d5qGG54K55Ye756Gu5a6a5ZKM5Y+W5raI5Z2H6L+b5YWl5q2k5aSEIOagueaNriBpbmRleCDov5vooYzliKTmlq1cbiAgdGFwRGlhbG9nQnV0dG9uKGU6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCfkvKDlhaXnmoTkuovku7bkuLo6JywgZSlcbiAgICAvL+WmguaenOeCueWHu+eahOaYr+ehruiupOaMiemSrlxuICAgIGlmIChlLmRldGFpbC5pdGVtLmluZGV4ID09IENPTkZJUk1fVVNFUl9UQVNLKSB7XG4gICAgICBjb25zb2xlLmxvZygn5b2T5YmN6aG16Z2i5pWw5o2u5Li6OicsIHRoaXMuZGF0YS5hY3RpdmVUYXNrKVxuICAgICAgY29uc29sZS5sb2coJ+W9k+WJjeeahCBkZXRhaWwg5pWw5o2u5Li6OicsIHRoaXMuZGF0YS51cGRhdGVEZXRhaWwpXG4gICAgICBhcGkudXBkYXRlUHJvY2Vzcyh7XG4gICAgICAgIHByb2Nlc3NfaWQ6IHRoaXMuZGF0YS5hY3RpdmVUYXNrLnByb2Nlc3MuaWQsXG4gICAgICAgIGRldGFpbDogdGhpcy5kYXRhLnVwZGF0ZURldGFpbCxcbiAgICAgICAgY29tcGxldGVkOiAxLFxuICAgICAgfSkudGhlbigocmVzOiBhbnkpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ+abtOaWsOeUqOaIt+S7u+WKoee7huiKgui/lOWbnue7k+aenOS4ujo6JywgcmVzKVxuICAgICAgICAvL+abtOaWsOWujOaIkOS5i+WQjumHjeaWsOaLieWPluaVsOaNrlxuICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgIGhpZGRlbk1vZGFsUHV0OiB0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMubG9hZERhdGEoKVxuICAgICAgfSkuY2F0Y2goKGVycjogYW55KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfmm7TmlrDnlKjmiLfku7vliqHnu4boioLlpLHotKUs57uT5p6c5Li6OicsIGVycilcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICBoaWRkZW5Nb2RhbFB1dDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9IGVsc2UgaWYgKGUuZGV0YWlsLml0ZW0uaW5kZXggPT0gQ0FOQ0VMX1VTUl9UQVNLKSB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBoaWRkZW5Nb2RhbFB1dDogdHJ1ZVxuICAgICAgfSlcbiAgICB9XG5cbiAgfSxcblxuICByYWRpb0NoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZygn54K55Ye75LqG5YiH5o2i5oyJ6ZKuJylcbiAgICB2YXIgaXRlbXMgPSB0aGlzLmRhdGEucmFkaW9JdGVtc1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGl0ZW1zW2ldLmNoZWNrZWQgPSBpdGVtc1tpXS52YWx1ZSA9PSBlLmRldGFpbC52YWx1ZVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhpdGVtcylcblxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICByYWRpb0l0ZW1zOiBpdGVtc1xuICAgIH0pO1xuICB9LFxuXG5cbn0pIl19